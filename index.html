<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Growfax.shop â€” Role Shop & Wallet (Simulated)</title>
<style>
  :root{
    --bg:#07120b; --accent:#00ffe0; --muted:#9fcdbf;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background: linear-gradient(180deg,#07120b 0%, #0f2b20 60%, #07120b 100%);
    color:#e9fff6; min-height:100vh; display:flex; flex-direction:column; align-items:center;
  }
  header{width:100%;display:flex;align-items:center;justify-content:space-between;padding:18px 28px;gap:12px}
  .brand{display:flex;align-items:center;gap:14px}
  .brand img{height:56px;border-radius:10px;box-shadow:0 8px 30px rgba(0,255,224,0.06)}
  .brand h1{font-size:1.25rem;color:var(--accent);margin:0}
  .wallet{display:flex;gap:10px;align-items:center}
  .balance{background:rgba(255,255,255,0.03);padding:8px 12px;border-radius:10px;color:var(--accent);font-weight:700}
  .topup-btn{background:linear-gradient(90deg,var(--accent),#0077ff);padding:8px 12px;border-radius:10px;color:#021;font-weight:700;border:none;cursor:pointer}
  main{width:100%;max-width:1100px;padding:12px 18px 80px 18px}
  .hero{display:flex;flex-direction:column;align-items:center;gap:6px}
  .banner{max-width:760px;width:92%;border-radius:14px;box-shadow:0 12px 50px rgba(0,255,224,0.06);margin-top:6px}
  .section{background:rgba(0,0,0,0.35);border-radius:14px;padding:20px;margin:22px 0;box-shadow:0 8px 30px rgba(0,0,0,0.35)}
  .section h2{color:var(--accent);margin:0 0 12px 0}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.25));padding:14px;border-radius:12px;position:relative;min-height:120px;display:flex;flex-direction:column;justify-content:space-between}
  .card h3{margin:0;color:var(--accent)}
  .card p{margin:6px 0 0 0;color:#d6efe6}
  .btn-buy{margin-top:10px;padding:8px 12px;border-radius:9px;border:none;cursor:pointer;font-weight:700;color:#001;background:linear-gradient(90deg,var(--accent),#0077ff);transition:transform .16s}
  .btn-buy:hover{transform:scale(1.03)}
  footer{width:100%;padding:16px 24px;text-align:center;color:#8fbfb0;position:fixed;bottom:8px;left:0}
  /* modal */
  .modal-back{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(6px);z-index:1200;align-items:center;justify-content:center}
  .modal{width:92%;max-width:520px;background:#0b0b0b;border-radius:12px;padding:18px;box-shadow:0 12px 40px rgba(0,0,0,0.6);color:#e9fff6;position:relative}
  .modal h3{margin:4px 0 10px 0;color:var(--accent)}
  .modal .row{display:flex;gap:8px;flex-wrap:wrap}
  .modal input[type="text"], .modal input[type="number"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#101010;color:#e9fff6;margin:8px 0}
  .modal .actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:10px}
  .action-btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .accent{background:linear-gradient(90deg,var(--accent),#0077ff);color:#021}
  .muted{background:rgba(255,255,255,0.03);color:#d8f1ea}
  .copy-btn{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:#0f0f0f;color:var(--accent);cursor:pointer}
  .close-x{position:absolute;right:12px;top:10px;color:#9fcdbf;cursor:pointer;font-weight:700}
  .note{font-size:.92rem;color:#bcd9d0;margin-top:8px}
  .admin-link{font-size:0.85rem;color:#9fcdbf;cursor:pointer;text-decoration:underline}
  @media(max-width:640px){.grid{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}}
</style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="https://vivj-cosr.github.io/growfax.shop/Growfax_banner.png" alt="Growfax" />
      <div>
        <h1>Growfax.shop</h1>
        <div style="font-size:0.85rem;color:var(--muted)">Official role shop (simulated wallet)</div>
      </div>
    </div>

    <div class="wallet">
      <div class="balance" id="balanceDisplay">Rp 0</div>
      <button class="topup-btn" id="openTopup">Top-Up</button>
    </div>
  </header>

  <main>
    <div class="hero">
      <img class="banner" src="https://vivj-cosr.github.io/growfax.shop/Growfax_banner.png" alt="banner">
      <div style="max-width:900px;margin-top:8px;color:#cfeee5">Top-up terlebih dahulu (minimal di atas harga VIP) lalu lakukan pembelian role. Semua transaksi akan tercatat di browser dan dikirim notifikasi ke Discord untuk verifikasi admin.</div>
    </div>

    <section class="section">
      <h2>Available Roles</h2>
      <div class="grid" id="rolesGrid"></div>
    </section>

    <section class="section">
      <h2>How it works</h2>
      <ol style="text-align:left;color:#d6efe6;line-height:1.6">
        <li>Top-up saldo (minimal lebih dari harga VIP).</li>
        <li>Pilih role & klik Buy â†’ modal konfirmasi.</li>
        <li>Jika saldo cukup, pembelian langsung memotong saldo & tercatat.</li>
        <li>Admin akan menerima notifikasi via Discord dan verifikasi manual.</li>
      </ol>
      <div style="margin-top:12px;"><span class="admin-link" id="adminOpen">Admin area</span></div>
    </section>
  </main>

  <!-- MODAL: TOPUP -->
  <div class="modal-back" id="topupModal">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="close-x" onclick="closeTopup()">âœ–</div>
      <h3>Top-Up Balance</h3>
      <div class="note">Minimum top-up: lebih dari harga VIP (Rp <span id="vipPriceText">25,000</span>)</div>
      <label style="display:block;text-align:left;margin-top:12px">Nominal (IDR)</label>
      <input type="number" id="topupAmount" placeholder="Masukkan nominal (contoh: 30000)" min="26000" />
      <label style="display:block;text-align:left;margin-top:6px">Pilih metode</label>
      <div class="row" style="margin-top:6px">
        <button class="action-btn accent" onclick="selectTopupMethod('PayPal')">PayPal</button>
        <button class="action-btn muted" onclick="selectTopupMethod('BNI')">BNI</button>
      </div>

      <div id="topupBNI" style="display:none;margin-top:12px">
        <div style="color:#bfffdc">Transfer ke rekening berikut:</div>
        <div style="margin-top:8px;background:#0b0b0b;padding:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:center">
          <div style="text-align:left">
            <div style="font-weight:700;color:var(--accent)">BNI 1949656911</div>
            <div style="font-size:0.9rem;color:#cfeee5">a.n. VivJ</div>
          </div>
          <button class="copy-btn" onclick="copyText('BNI 1949656911 (a.n. VivJ)')">Copy</button>
        </div>
        <div class="note">Setelah transfer, klik "Mark as Paid" untuk menambah saldo.</div>
      </div>

      <div id="topupPaypal" style="display:none;margin-top:12px">
        <div style="color:#bfffdc">Kamu akan diarahkan ke PayPal:</div>
        <div style="margin-top:8px"><button class="action-btn accent" id="paypalRedirectBtn">Open PayPal</button></div>
        <div class="note">Setelah selesai transfer via PayPal, klik "Mark as Paid".</div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;justify-content:center">
        <button class="action-btn accent" id="markTopupBtn" onclick="markTopupPaid()" style="display:none">Mark as Paid</button>
        <button class="action-btn muted" onclick="closeTopup()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- MODAL: BUY -->
  <div class="modal-back" id="buyModal">
    <div class="modal">
      <div class="close-x" onclick="closeBuy()">âœ–</div>
      <h3 id="buyRoleTitle">Buy Role</h3>
      <div id="buyPrice" style="margin:6px 0;color:#bfeee6"></div>
      <label style="display:block;text-align:left;margin-top:8px">Enter your Growtopia name / Discord</label>
      <input id="buyPlayerName" type="text" placeholder="Your in-game name" />
      <div style="margin-top:8px">
        <button class="action-btn accent" onclick="confirmBuy()">Confirm & Pay from Balance</button>
        <button class="action-btn muted" onclick="closeBuy()">Cancel</button>
      </div>
      <div class="note" style="margin-top:10px">If your balance is insufficient you'll be asked to top-up.</div>
    </div>
  </div>

  <!-- ADMIN MODAL (password) -->
  <div class="modal-back" id="adminModal">
    <div class="modal" style="max-width:900px;">
      <div class="close-x" onclick="closeAdmin()">âœ–</div>
      <h3>Admin â€” Purchase & Topup Log</h3>
      <div style="margin:8px 0;color:#cfeee5">Local log (browser) & notifications are also sent to Discord channel.</div>
      <div style="overflow:auto;max-height:60vh;margin-top:10px;background:#060606;border-radius:8px;padding:8px">
        <table id="adminTable" style="width:100%;border-collapse:collapse;color:#dff7ee">
          <thead><tr style="border-bottom:1px solid rgba(0,255,224,0.06)"><th style="padding:8px;text-align:left">Type</th><th style="padding:8px;text-align:left">User</th><th style="padding:8px;text-align:left">Item</th><th style="padding:8px;text-align:left">Amount</th><th style="padding:8px;text-align:left">Method</th><th style="padding:8px;text-align:left">Time</th></tr></thead>
          <tbody id="adminTBody"></tbody>
        </table>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;justify-content:center">
        <button class="action-btn accent" onclick="exportLogs()">Export JSON</button>
        <button class="action-btn muted" onclick="clearLogs()">Clear Local Logs</button>
      </div>
    </div>
  </div>

  <footer>
    Â© 2025 VivJ â€” Powered by Growfax â€¢ <span style="cursor:pointer;text-decoration:underline" id="openAdminLink">Admin</span>
  </footer>

<script>
/* ==== CONFIG ==== */
const VIP_PRICE = 25000; // minimal topup must be > VIP_PRICE
const ROLES = [
  {id:1,name:"VIP", price:25000},
  {id:2,name:"VIP+", price:50000},
  {id:3,name:"Moderator", price:100000},
  {id:4,name:"Super Moderator", price:200000},
  {id:5,name:"Developer", price:400000},
  {id:6,name:"God", price:600000},
  {id:7,name:"God [MAX]", price:1000000}
];
const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1433382270886219817/JVLQ4Ei1IB94vMiEgowjOhmL_OkPcotKesB6mEsjjPKYdRnuVhoo_PgsWrWGkYyHkjk5";
const ADMIN_PASSWORD = "azzahran111";
const PAYPAL_LINK = "https://paypal.me/BilzXd1";

/* ==== Utilities ==== */
const $ = id => document.getElementById(id);
function fmtIDR(n){ return "Rp " + Number(n).toLocaleString('id-ID'); }
function now(){ return new Date().toLocaleString(); }

/* ==== Wallet & storage ==== */
function getWallet(){ return Number(localStorage.getItem("gw_balance")||0); }
function setWallet(v){ localStorage.setItem("gw_balance", Math.max(0, Math.round(v))); updateBalanceUI(); }
function pushLog(obj){
  const logs = JSON.parse(localStorage.getItem("gw_logs")||"[]");
  logs.push(obj);
  localStorage.setItem("gw_logs", JSON.stringify(logs));
}
function getLogs(){ return JSON.parse(localStorage.getItem("gw_logs")||"[]"); }
function updateBalanceUI(){ $("balanceDisplay").innerText = fmtIDR(getWallet()); }

/* ==== Render roles ==== */
function renderRoles(){
  const grid = document.getElementById("rolesGrid");
  grid.innerHTML = "";
  ROLES.forEach(r=>{
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `<div><h3>${r.name}</h3><p style="margin-top:6px">${fmtIDR(r.price)}</p></div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <button class="btn-buy" onclick="openBuy(${r.id})">Buy Role</button>
        <div style="font-size:0.85rem;color:var(--muted)">${r.id}</div>
      </div>`;
    grid.appendChild(card);
  });
}

/* ==== Topup flow ==== */
$("openTopup").addEventListener("click", ()=>{ openTopup(); });

function openTopup(){
  $("topupModal").style.display = "flex";
  $("topupAmount").value = VIP_PRICE + 1000;
  $("topupBNI").style.display = "none";
  $("topupPaypal").style.display = "none";
  $("markTopupBtn").style.display = "none";
}
function closeTopup(){ $("topupModal").style.display = "none"; }

function selectTopupMethod(m){
  const amt = Number($("topupAmount").value || 0);
  if(!amt || amt <= VIP_PRICE){
    alert("Top-up minimal harus lebih dari harga VIP: " + fmtIDR(VIP_PRICE));
    return;
  }
  if(m === "BNI"){
    $("topupBNI").style.display = "block";
    $("topupPaypal").style.display = "none";
  } else {
    $("topupBNI").style.display = "none";
    $("topupPaypal").style.display = "block";
    $("paypalRedirectBtn").onclick = ()=>{ window.open(PAYPAL_LINK, "_blank"); };
  }
  $("markTopupBtn").style.display = "inline-block";
}

async function markTopupPaid(){
  const amt = Number($("topupAmount").value || 0);
  if(!amt || amt <= VIP_PRICE){ alert("Nominal invalid atau terlalu kecil."); return; }
  // add to wallet
  const old = getWallet();
  setWallet(old + amt);
  // log
  const entry = {type:"topup", user: "Unknown (web)", amount:amt, method: $("topupBNI").style.display==="block" ? "BNI" : "PayPal", time: now()};
  pushLog(entry);
  // notify discord
  try{
    await fetch(DISCORD_WEBHOOK, {method:"POST", headers:{"Content-Type":"application/json"}, body: JSON.stringify({content:`ðŸ“¥ **Top-Up**\nðŸ’³ Amount: ${fmtIDR(amt)}\nðŸ§¾ Method: ${entry.method}\nðŸ•’ Time: ${entry.time}`})});
  }catch(e){ console.warn("Webhook failed", e); }
  alert("Top-up marked as paid. Saldo telah bertambah: " + fmtIDR(amt));
  closeTopup();
}

/* ==== Buy flow ==== */
let currentBuyRole = null;
function openBuy(roleId){
  const r = ROLES.find(x=>x.id===roleId);
  if(!r) return;
  currentBuyRole = r;
  $("buyRoleTitle").innerText = `Purchase Role â€” ${r.name}`;
  $("buyPrice").innerText = fmtIDR(r.price);
  $("buyPlayerName").value = "";
  $("buyModal").style.display = "flex";
}
function closeBuy(){ $("buyModal").style.display = "none"; }

async function confirmBuy(){
  const user = $("buyPlayerName").value.trim() || "Unknown";
  if(!currentBuyRole) return;
  const bal = getWallet();
  if(bal < currentBuyRole.price){
    alert("Saldo tidak cukup. Silakan top-up dulu.");
    closeBuy();
    openTopup();
    return;
  }
  // deduct
  setWallet(bal - currentBuyRole.price);
  const entry = {type:"purchase", user:user, role: currentBuyRole.name, amount: currentBuyRole.price, method:"Balance", time: now()};
  pushLog(entry);
  // notify discord
  try{
    await fetch(DISCORD_WEBHOOK, {method:"POST", headers:{"Content-Type":"application/json"}, body: JSON.stringify({content:`ðŸ“¢ **New Role Purchase**\nðŸ‘¤ User: ${user}\nðŸ’Ž Role: ${currentBuyRole.name}\nðŸ’° Amount: ${fmtIDR(currentBuyRole.price)}\nðŸ•’ Time: ${entry.time}`})});
  }catch(e){ console.warn("Webhook failed", e); }
  alert("Purchase successful â€” saldo terpotong. Admin akan memverifikasi.");
  closeBuy();
}

/* ==== Admin area ==== */
document.getElementById("openAdminLink").addEventListener("click", ()=>{ openAdmin(); });
document.getElementById("adminOpen").addEventListener("click", ()=>{ openAdmin(); });

function openAdmin(){
  const pw = prompt("Enter admin password:");
  if(pw !== ADMIN_PASSWORD){ alert("Access denied"); return; }
  fillAdminTable();
  $("adminModal").style.display = "flex";
}
function closeAdmin(){ $("adminModal").style.display = "none"; }

function fillAdminTable(){
  const tbody = $("adminTBody");
  tbody.innerHTML = "";
  const logs = getLogs().slice().reverse();
  logs.forEach(l=>{
    const tr = document.createElement("tr");
    tr.style.borderBottom = "1px solid rgba(0,255,224,0.03)";
    tr.innerHTML = `<td style="padding:8px">${l.type}</td><td style="padding:8px">${l.user||"n/a"}</td><td style="padding:8px">${l.role||"-"}</td><td style="padding:8px">${fmtIDR(l.amount||0)}</td><td style="padding:8px">${l.method||"-"}</td><td style="padding:8px">${l.time||"-"}</td>`;
    tbody.appendChild(tr);
  });
}

function exportLogs(){
  const logs = getLogs();
  const blob = new Blob([JSON.stringify(logs, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "growfax_logs.json"; a.click();
  URL.revokeObjectURL(url);
}
function clearLogs(){
  if(!confirm("Clear all local logs? This cannot be undone.")) return;
  localStorage.removeItem("gw_logs");
  setWallet(0);
  updateBalanceUI();
  fillAdminTable();
  alert("Cleared.");
}

/* ==== helper copy ==== */
function copyText(txt){ navigator.clipboard.writeText(txt).then(()=>alert("Copied to clipboard")); }

/* ==== init ===== */
updateBalanceUI();
renderRoles();

/* close helpers for modals */
window.onclick = function(e){
  if(e.target === $("topupModal")) closeTopup();
  if(e.target === $("buyModal")) closeBuy();
  if(e.target === $("adminModal")) closeAdmin();
};
</script>
</body>
</html>
